function [AA, rr, x] = f_Gauss_Direta_2(A,r)% Subrotina para resolver um sistema de equacoes algebricas lineares% pelo metodo de Gauss com Substituicao Direta% ULTIMA MODIFICACAO: 05/09/2018n=length(r);[nr,nc]=size(A);% Verificacao da matriz A e do vetor rif nr ~= nc    error('Matriz dos coeficientes nao e quadrada.')endif nr ~= n    error('Matriz A e vetor b tem dimensoes diferentes.')end% Verificando se a matriz A e singular (estima o numero de equacees% linearmente independentes)if det(A) == 0    fprintf('\n Rank=%7.3g\n',rank(A))    error('A matriz A e singular.')end% Metodo de Eliminacao de Gauss com Substituicao Direta% Etapa de eliminacaofor i = n:-1:2   for j = i-1:-1:1      Mji = A(j,i)/A(i,i);      r(j) = r(j) - Mji*r(i);      A(j,:) = A(j,:)- Mji*A(i,:);    endfor   % Fim do for jendfor       % Fim do for i      % Etapa de Substituicao Diretax = zeros(n,1);x(1) = r(1)/A(1,1);for i = 2:n  soma = 0;  for k = 1:i-1    soma = soma + A(i,k)*x(k);  endfor % Fim do for k  x(i) = 1/A(i,i)*(r(i) - soma);endfor  % Fim do for i    % Retorna os valores da Nova Matriz A e do Novo Vetor r  AA = A;  rr = r;